<!DOCTYPE html><html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#000000">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link rel="manifest" href="../assets/manifest.json">
    <link rel="icon" href="../assets/favicon.png">
    <link rel="stylesheet" href="../assets/global_styles.css">
    <link rel="stylesheet" href="../assets/artist_styles.css">
    <script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;fafca58fc0304523be0fede299408817&quot;}"></script>
    <title>Add N To (X)</title>
</head>

<body>
    <nav>
        <p><a href="../index.html">Index</a> / Add N To (X)</p>
        <p><span>Cached On</span> Thu Jan 08 2026</p>
    </nav>
    <header>
        <div class="header-artist"><img class="cover-art small" src="https://i.scdn.co/image/ce5d23f560bfc073bd5b1ff3dbcea9288883a7db" alt="Add N To (X)"><a class="cover-art-link" href="spotify:artist:3pcItz4w7h7fpTDgnTYIUn"><img class="cover-art large" src="https://i.scdn.co/image/ce5d23f560bfc073bd5b1ff3dbcea9288883a7db" alt="Add N To (X)"></a><img class="cover-art medium" src="https://i.scdn.co/image/ce5d23f560bfc073bd5b1ff3dbcea9288883a7db" alt="Add N To (X)"></div>
        <div class="header-meta">
            <p><span>Followers</span> 9,586</p>
            <p><span>Popularity</span> 15</p>
            <p class="genre-list">electroclash, space rock, musique concrète</p>
        </div>
    </header>
    <main data-artist-name="add n to (x)">
        <div class="filters">
            <div class="release-year-filters"><label for="year-all"><input name="release-year" type="radio" id="year-all" value="year-all" checked>all</label><label><input name="release-year" type="radio"></label><label for="1999"><input name="release-year" type="radio" id="1999" value="1999">1999</label><label for="1998"><input name="release-year" type="radio" id="1998" value="1998">1998</label><label for="1996"><input name="release-year" type="radio" id="1996" value="1996">1996</label></div>
            <div class="viewed-filters"><label for="everything"><input name="viewed-filter" type="radio" id="everything" value="everything">everything</label><label for="new"><input name="viewed-filter" type="radio" id="new" value="new" checked> new</label><label for="viewed"><input name="viewed-filter" type="radio" id="viewed" value="viewed">viewed</label></div>
        </div>
        <div class="albums-list">
            <section class="album"><a href="spotify:album:2zhN7Bz0lSkgXQ5nOYsjL1"><img class="album-cover-art" src="https://i.scdn.co/image/ab67616d0000b273b2d35b5e711a00c27ab1221b" alt="Loud Like Nature"></a>
                <div class="album-meta">
                    <h2 class="album-name"><a href="spotify:album:2zhN7Bz0lSkgXQ5nOYsjL1">Loud Like Nature</a></h2>
                    <p class="artist-list">Add N To (X)</p>
                    <p><span>2002</span> - album </p><button type="button" class="viewed-button" data-artist-name="add n to (x)" data-album-name="loud like nature">…</button>
                </div>
            </section>
            <section class="album"><a href="spotify:album:4uE2XqptEndSFTnbmSTjGV"><img class="album-cover-art" src="https://i.scdn.co/image/ab67616d0000b2730de41bd7609f31bf4bf40a76" alt="Add Insult To Injury"></a>
                <div class="album-meta">
                    <h2 class="album-name"><a href="spotify:album:4uE2XqptEndSFTnbmSTjGV">Add Insult To Injury</a></h2>
                    <p class="artist-list">Add N To (X)</p>
                    <p><span>2000</span> - album </p><button type="button" class="viewed-button" data-artist-name="add n to (x)" data-album-name="add insult to injury">…</button>
                </div>
            </section>
            <section class="album" data-release-year="1999"><a href="spotify:album:4i4u4qrfMJOJN5USQYgzx1"><img class="album-cover-art" src="https://i.scdn.co/image/ab67616d0000b2731cb4198839f6683b85946474" alt="Avant Hard"></a>
                <div class="album-meta">
                    <h2 class="album-name"><a href="spotify:album:4i4u4qrfMJOJN5USQYgzx1">Avant Hard</a></h2>
                    <p class="artist-list">Add N To (X)</p>
                    <p><span>1999-04-20</span> - album </p><button type="button" class="viewed-button" data-artist-name="add n to (x)" data-album-name="avant hard">…</button>
                </div>
            </section>
            <section class="album" data-release-year="1998"><a href="spotify:album:05a8UAWC9nLW2ANwzaMmEW"><img class="album-cover-art" src="https://i.scdn.co/image/ab67616d0000b27364c4be458546165fe6e3e191" alt="On the Wires of Our Nerves"></a>
                <div class="album-meta">
                    <h2 class="album-name"><a href="spotify:album:05a8UAWC9nLW2ANwzaMmEW">On the Wires of Our Nerves</a></h2>
                    <p class="artist-list">Add N To (X)</p>
                    <p><span>1998-01-01</span> - album </p><button type="button" class="viewed-button" data-artist-name="add n to (x)" data-album-name="on the wires of our nerves">…</button>
                </div>
            </section>
            <section class="album" data-release-year="1996"><a href="spotify:album:5DnUPCyDckjCnyKs28xuii"><img class="album-cover-art" src="https://i.scdn.co/image/ab67616d0000b27303731a3181de0ebefc69b557" alt="Vero Electronics"></a>
                <div class="album-meta">
                    <h2 class="album-name"><a href="spotify:album:5DnUPCyDckjCnyKs28xuii">Vero Electronics</a></h2>
                    <p class="artist-list">Add N To (X)</p>
                    <p><span>1996-01-29</span> - album </p><button type="button" class="viewed-button" data-artist-name="add n to (x)" data-album-name="vero electronics">…</button>
                </div>
            </section>
        </div>
    </main>
    <script type="module">
        /*
         * I enabled CORS on `mhunter-backend` so these aren't a problem directly from the browser
         */

        /**
         * @typedef {Object} Artist
         * @property {string} name
         * @property {string[]} viewed
         */

        /**
         * @param {string} name
         * @returns {Promise<Artist>}
         */
        export async function fetch_artist_viewed(artist_name) {
            const response = await fetch(
                `https://mhunter-backend.vercel.app/artist?name=${artist_name}`,
            )

            return response.json()
        }

        export async function update_artist_viewed(artist_name, viewed_array) {
            const password_hash = localStorage.getItem('super_secret')

            const response = await fetch(
                `https://mhunter-backend.vercel.app/artist?name=${artist_name}&super_secret=${password_hash}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(viewed_array),
                },
            )

            return response.json()
        }

        // deno-lint-ignore-file no-window

        // Initial page load, get latest viewed albums
        const $main = document.querySelector('main')

        /**
         * @typedef {Object} Artist
         * @property {string} name
         * @property {string[]} viewed
         */

        /** @type {Artist} */
        const artist = await fetch_artist_viewed($main.dataset.artistName)

        window.__artist = artist ?? {
            name: $main.dataset.artistName,
            viewed: []
        }

        const $viewed_buttons = document.querySelectorAll('.viewed-button')

        $viewed_buttons.forEach(($button) => {
            $button.addEventListener('click', toggle_viewed_status)

            if (window.__artist.viewed.includes($button.dataset.albumName)) {
                $button.innerHTML = 'Viewed'
                $button.classList.add('is-viewed')
            } else {
                $button.innerHTML = 'New'
            }
        })

        const $year_filters = document.querySelectorAll('input[name="release-year"]')

        $year_filters.forEach(($input) => {
            $input.addEventListener('click', filter_by_year)
        })

        const $viewed_filters = document.querySelectorAll('input[name="viewed-filter"]')

        $viewed_filters.forEach(($input) => {
            $input.addEventListener('click', filter_by_viewed_status)
        })

        // Fake an event on initial page load to default to only showing new albums
        // filter_by_viewed_status({ currentTarget: { value: 'new' } })

        function filter_by_year(event) {
            const filter_selection = event.currentTarget.value

            if (filter_selection === 'year-all') {
                for (const $album of document.querySelectorAll('.album')) {
                    $album.classList.remove('hidden')
                    $album.classList.add('visible')
                }

                return
            }

            for (const $album of document.querySelectorAll('.album')) {
                if ($album.dataset.releaseYear === filter_selection) {
                    $album.classList.remove('hidden')
                    $album.classList.add('visible')
                } else {
                    $album.classList.remove('visible')
                    $album.classList.add('hidden')
                }
            }
        }

        function filter_by_viewed_status(event) {
            const filter_selection = event.currentTarget.value

            if (filter_selection === 'everything') {
                for (const $album of document.querySelectorAll('.album')) {
                    $album.style.display = 'flex'
                }

                return
            }

            document.querySelectorAll('section:has(.is-viewed)').forEach(($album) => {
                $album.style.display = filter_selection === 'new' ? 'none' : 'flex'
            })

            document.querySelectorAll('section:not(:has(.is-viewed))').forEach(($album) => {
                $album.style.display = filter_selection === 'new' ? 'flex' : 'none'
            })
        }

        async function toggle_viewed_status(event) {
            const $button = event.currentTarget
            const artist = window.__artist

            if ($button.classList.contains('is-viewed')) {
                const album_index = artist.viewed.indexOf($button.dataset.albumName)

                artist.viewed.splice(album_index, 1)

                $button.innerHTML = 'New'
                $button.classList.remove('is-viewed')
            } else {
                artist.viewed.push($button.dataset.albumName)
                artist.viewed.sort()

                $button.innerHTML = 'Viewed'
                $button.classList.add('is-viewed')
            }

            await update_artist_viewed(artist.name, artist.viewed)
        }
    </script>
</body>

</html>